
import numpy as np 
import math
import re
import numpy as np
from sentence_transformers import SentenceTransformer
model = SentenceTransformer('sentence-transformers/all-MiniLM-L6-v2')



def remove_non_english_chars(input_string):
    return re.sub(r"[a-z_]", '', input_string)



#target_element = '-0.1883618437618674, -0.03287400094339814, 0.041472383235261714, -0.08112950398298542, 0.00939018466816915, -0.18151269561679242, -0.06480116467633935, 0.15717233543191567, 0.5364064515147867, -0.023031825173439272, -0.10755062248774667, -0.21916666765204615, -0.03168263946687659, -0.21708020047435977, -0.28014124357530995, -0.09184918982860303, 0.04454867686558756, 0.1176065317220691, 0.10453880192015289, 0.04727038870903613, -0.029245904547289724, -0.11905712471670049, 0.08322324763996733, 0.1596549171084551, -0.12714707613273024, 0.16670427643957594, 0.0674170003515815, -0.00035224655544940177, -0.012290498899416247, -0.19374194541520012, -0.11814931140665563, -0.18842353645655652, -0.11302989162990136, -0.08028936378191075, -0.05837862558838664, -0.0026637424426738366, 0.07414386167667153, -0.34136384931191566, 0.169857417467653, 0.06986304533818903, -0.031164256663253034, 0.2752067661043833, -0.0037533329212022224, 0.015858461736189294, 0.12313442181748115, 0.0766039905697697, -0.04582069678817671, 0.4604844935578018, -0.02777629951324359, -0.11248460621962016, 0.21881840881091807, 0.2428920388158155, -0.2214790204465413, -0.058896125833452724, -0.03888481412081148, -0.09977503472684736, -0.07326675276399346, -0.05686001386744787, 0.09860945877237573, 0.07675882096509437, 0.07117940302774962, -0.027012099464410015, 0.10652848389994865, 0.09944112517695099, 0.24184375674515404, 0.12642221782882418, -0.04836951973043225, 0.24437224381015862, 0.0490644512759802, 0.014908648205002694, 0.15462755497815767, 0.14431845635738813, 0.37957569710330546, -0.11103061876899846, -0.0040100486845428985, 0.31942633194649717, -0.16890214349112564, -0.06929145597985212, -0.29914874059076263, 0.3419041973316655, -0.11064482341635588, 0.013182559619264308, 0.04704660765494131, -0.18467429192615442, 0.09520784973754713, 0.10270542538110303, 0.2571602580949981, 0.04487351087451351, -0.22818451521410696, -0.13106808013624133, -0.03466478631737703, -0.1725280149756259, 0.008087958716069986, 0.14836617848888606, 0.10545826747185169, 0.13610174978294254, -0.1436522172225654, -0.41017028690465973, 0.44625300846417243, 0.03155392169572456, 0.23972823302419075, 0.165614211701543, -0.07214222504005176, -0.03763342014716701, 0.21273690145870316, -0.1681704839317627, -0.13261344634212177, -0.1590366076922154, 0.1458508125392185, -0.09161682388672183, 0.010511157470928277, 0.09367707352068678, 0.207238253058713, 0.16037540582174092, -0.09367978908547901, -0.3494121661822899, 0.5846121208545674, -0.054405254386552526, 0.04571289195179398, 0.01024474127812806, -0.15424122885603295, -0.2675836326196155, -0.004225676486789214, -0.18972687177859068, -0.0026686416455752857, 0.10812507553259176, -0.3764101879119474, 9.155991241445038e-33, -0.19684204652549428, 0.19544644371790568, 0.19151671287663047, -0.4682020793234342, -0.06035401999433234, -0.06851288503870326, -0.05229817360339783, 0.0661881949396179, -0.2919444953186736, -0.007764167730893783, -0.22469323699549104, -0.515164118736181, -0.11347916948130064, -0.03785028885451796, 0.2008935457607487, -0.11890769459226948, 0.01470914368297665, -0.1737964552900798, -0.15062071444025923, -0.10326804103214923, -0.02466635602351212, 0.006624999872559396, 0.30284998134172375, -0.07952645671222257, -0.2733049573325691, 0.06257197605360644, -0.04480464353420856, -0.06325715625285501, 0.1288969860848478, -0.052588078660183626, 0.20811264023486067, -0.24681032725453436, 0.12665117697123876, 0.23158469857741962, 0.025070952033537326, -0.008903668091621766, 0.08269587878557673, -0.0644048033079597, 0.12697218141663383, 0.030273202708193003, 0.19429542689376336, -0.015026943453329979, -0.2523932815978472, -0.0994937207295861, 0.20983213586130517, 0.059902409225906984, -0.2822464728370154, 0.014761302585136636, -0.0617792594885853, -0.43255179911360897, -0.1680814998109116, 0.08366627352060632, 0.01781437042181615, 0.21731077661217335, 0.016958118898263902, 0.03526586424066237, -0.01621955316389523, -0.15593129763491068, -0.0568345986496878, -0.01975609336727265, -0.16637076805266024, 0.06250467942066427, 0.2384562131016016, -0.2685344999750936, 0.0042943764186964585, -0.06216552389332836, 0.1502393503956185, 0.09650206323057466, -0.014715448113511356, -0.02264143496173346, -0.17220633163903276, -0.09030129938181342, 0.029006046115277222, 0.3203108901471394, 0.07207110192944781, 0.0038897294918313987, 0.1316447179763965, -0.026992201780568714, 0.16888992344956058, -0.12504905546120054, -0.14581742343575033, 0.13846258775245548, 0.11786802826808519, -0.07199746692141103, -0.2385139065099603, -0.19593264090700308, -0.08637794394606178, 0.161496452685358, -0.04230972455307893, -0.3801158229404814, -0.018653459884468367, 0.2477447037256378, -0.0031912144808118694, -0.1949711705053589, -0.19022263516184254, 5.825092427836506e-34, -0.019917009096427185, -0.014836298461438609, 0.006406786112022291, -0.06505032391776527, -0.26793628573831646, 0.014866555407788478, 0.19630729010052117, -0.008596572429646928, -0.09373076147097693, 0.033697057773234375, -0.26527115639035703, -0.030350651850415238, 0.20878950710280209, -0.19769696803947215, 0.248498100146815, 0.1982652246592004, 0.3231066134746528, -0.13836464226779002, 0.12065139577579388, -0.20760890296590068, -0.22619951141183964, -0.18926138694277228, -0.04974823974827274, -0.1501214331662538, -0.15760488787289004, 0.02761037541856882, 0.35351294057504706, -0.14106590097096253, 0.10995118176408424, -0.008721250026703242, 0.12477952331209469, 0.2219521212072543, -0.14820866338745997, 0.15792873131784063, 0.153199957879926, 0.19039539445653414, 0.49093091226931057, 0.11197259882152019, -0.041285657297104594, -0.012531297750031516, -0.20505704970020655, 0.26491297339426095, 0.008515434902404329, 0.057611293382434745, -0.042733877258411865, 0.18900770381727203, 0.12210403778749578, 0.15971367205577805, -0.023480421047771424, 0.022912340322580844, -0.1605338343404153, -0.06351915888140057, -0.0797101831856319, -0.017138410799384867, 0.049671370749437935, -0.04636590505173086, 0.15037943650846897, 0.20229114821150246, 0.17468554354653457, 0.10145585207021697, -0.28387911976401364, 0.018125581861679223, -0.23798565509701222, -0.2199608962929175, 0.07135615543703343, 0.012710170922841992, -0.16435908999804735, -0.08194690750066326, 0.1834153560884733, -0.05845426023958861, -0.16641505644572635, 0.22444239286954631, 0.009020167364143275, 0.004213099641611531, -0.012500300195101946, 0.1158776797405677, -0.12420688475826985, 0.03769610340583145, -0.04711319145212551, 0.02789921276465222, 0.11659814376690085, 0.17521886812825357, 0.07359758261654589, 0.10264397338420234, 0.32623575878474753, -0.09978246549959703, 0.2584693578204776, 0.15140521642178387, -0.17221038029926844, 0.1516857589517746, -0.0836754076930893, 0.16525091850624699, 0.15586804966220422, -0.0832981416825896, 0.1012202459657996, 8.695804358399216e-08, 0.021948769987026294, -0.25318973206445766, 0.13162905410493586, 0.3221931715394022, -0.1441721121020392, 0.04556976934376676, -0.07234923748155452, 0.31646095988032696, -0.2227722217745099, -0.22433283217365588, -0.04325808618286241, 0.052232185378946465, -0.2552198142422761, 0.31068263299368903, -0.18919844755697401, 0.2597809262412228, -0.14043829691704754, 0.02803015544741244, 0.1452889868706573, -0.11459468646752265, -0.13715204384024554, 0.13469691405506035, 0.08673619483127766, -0.13310865426893886, 0.3278438175068997, -0.05545190711833866, 0.031348489219191825, -0.14317116726309695, -0.24125981156701243, -0.30557584059321863, -0.051327356104304, -0.1828799454592548, -0.06558371638860411, 0.09487884054775313, -0.014835565567531614, 0.22044226718277052, -0.2748242170860151, 0.12903049312481524, 0.26506790870913444, 0.07091963456841949, 0.04988336686950827, 0.15807449542980212, -0.027334125332471263, -0.04290525716962376, -0.04134676984840625, -0.010764160933763202, -0.025418939318186177, 0.006309091354219751, 0.11915587252732729, 0.11233985427271759, -0.08732870638199113, -0.11515578387098047, -0.15211036219399351, 0.07156382825451976, 0.31312901125415743, -0.16474558892884067, -0.13322886738490067, -0.08306019031766983, 0.40880011165830754, 0.09586897250143174, -0.14461898297555448, 0.19417355975197356, 0.15960186484719585, -0.21773341724165607'
#line_numbers = find_all_line_numbers_of_target(file_path, target_element)

f = open("library_adj.txt", 'r')
file_path = 'library_adj.txt'

#user input
sentences = input()

user_sent_vec = []
definition_vec = []
definition_vec_temp = []
#rate_orig = 0
rate = 0
rate_temp = 0
target_element = ''
best_fit = -1
best_word = ''
embeddings = model.encode(sentences)

user_list = embeddings.tolist()
print(user_list)
norm = 0
for i in user_list:
    norm += i*i

norm = math.sqrt(norm)

for i in user_list:
    user_sent_vec.append(i/norm)
rate = 0
for y, yy in zip(user_sent_vec, user_sent_vec):
    rate_temp = (y)* (yy)
    rate += rate_temp
print(rate)



for j in f:
    rate = 0
    rate_temp = 0
    definition_vec_temp = j.split(": [")[1]
    definition_vec = definition_vec_temp.split("]\n")[0]#.split(", ")
    definition_vec = definition_vec.split(", ")
    for (k, kk) in zip(definition_vec, user_sent_vec):
        rate_temp = float(k)* float(kk)
        rate += rate_temp
    if rate > best_fit:
        best_fit = rate
        best_word = j.split(": [")[0]
    '''elif rate == best_fit:
        best_word += str(j.split(": [")[0])
    elif best_fit - rate < 0.05:
        best_word += str(j.split(": [")[0])'''
    

'''for var in best_fit:
     for current_line_number, line in enumerate(f, 1):
            if current_line_number == var:
                line.strip()
                final = remove_non_english_chars(line)
            '''
print("accuracy: " + str(best_fit))
print(best_word)
